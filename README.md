# Robot Path Planning Visualization
A testing ground for path planning strategies for ROS.

## Future Work
- Release 0.2.0
    - Command Line Scripts
        - [ ] Implement D* Lite algorithm
    - GUI
        - [ ] Change behavior of the pen and eraser to support dragging movements
        - [ ] [Optional] Animate traversal of map and final path
    - Bug Fixes/Optimizations
        - [ ] Add more extensive error handling for GUI
        - [X] Get eraser to scale with map scaling in graphics view
        - [X] Disable fullscreen
    - Testing
        - [ ] Test D* Replan with changing map
        - [ ] Rewrite tests with GTest

## Dependencies
- CMake
- OpenCV
- Qt6

## Quick Start
1. Install dependencies:
    ```bash
    sudo apt -y install libopencv-dev build-essential libgl1-mesa-dev qt6-base-dev qt6-tools-dev libqt6svg6-dev
    ```
2. Build Executables

    ```bash
    mkdir build
    cmake -S . -B ./build
    cmake --build ./build
    ```
3. Run executable files

## Usage
This project can be run as a GUI or as a script. 

### GUI
To open the GUI run this command:
```bash
./build/rpp_viz
```

![](/resources/graphics/gui.png)

Features
 - Upload ROS maps (.yaml file paired with a .pgm file)
 - Dynamically inflation the size of obstacles
 - Add or remove obstacles from map
 - Set algorithm (if the "All" option is chosen the results will be color coded)
    - Set the maximum number of iterations for sample-based algoirthms
 - Set the start and goal positions
 - View results for comparison
 - Show some debug data for algorithms

### Script
This script requires the user to specify a yaml file for map information, the name of algorithm being used, and the start & end position. Certain algorithms require the user to specify the number of iterations to reduce the likelihood of an infinite loop (by default it is set to 10,000). If the map has thin or unexpected broken boudnaries it may also be benefitial to inflate their size to remedy this issue(by default boundaries are inflated by a 3x3 matrix). Look below for a more thorough breakdown of the possible commands for this script.
```bash
./build/rpp_cli -h

# Ouptut
Description: A simple script to test different path planning algorithms.
options: 
   -h, --help                            Show this help message and exit.
   -f FILE, --file FILE                  Provide map yaml filepath.
   -i INFLATE_SIZE. --inflate-size INFLATE_SIZE
                                         Set size of boundaries (Default: 3).
   -a ALGORITHM, --algorithm ALGORITHM   Set executed algoritm to one of the following:
                                         [bfs, a-star, rrt-star, all].
   -l MAX_ITER, --max-iter MAX_ITER      Set limit the number of iterations executed.
                                         Only supported for sample-based methods (Default: 10000).
   -s START_POS, --start-pos START_POS   Set start position [Format: "int,int"].
   -e END_POS, --end-pos END_POS         Set end position [Format: "int,int"].
   -d, --debug                           Provide more information for debugging.
   -t TIMEOUT, timeout TIMEOUT           Set timeout limit for algorithm computation
                                         (Default: 600000 ms).
```

Example execution:
```bash
./build/rpp_cli -f "/path/to/example1.yaml" -i 5 -a "rrt-star" -l 10000 -s "300,50" -e "381,360" -d
```

## Maps
Maps are based on a occupancy grid generated by the slam_toolbox ROS package. Therefore a yaml and pgm file are necessary to retreive the map data.

### Generating ROS Maps
ROS maps can also be generated with a text file. Within the text file a `0` indicates a vacant space while a `1` is used to illustrate an obstacle. The generated pgm and yaml map files will appear in the current working directory.

File format:
```
0.05                                        ; resolution
10 20                                       ; height, width
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0     ; map data
1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0     ; map data
1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1     ; map data
1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1     ; map data
1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1     ; map data
1,0,0,0,1,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1     ; map data
1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1     ; map data
1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,1     ; map data
1,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,0,1     ; map data
1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1     ; map data
```

Script execution:
```bash
./build/generate_map -f "/path/to/map.txt" -t "map_name"
```

## Algorithms Tested
### Graph Search Algorithms
- [BFS](https://en.wikipedia.org/wiki/Breadth-first_search)

    ![](/resources/graphics/BFS.png)

- [A*](https://en.wikipedia.org/wiki/A*_search_algorithm)

    ![](/resources/graphics/A_star.png)

### Sampling-Based Algorithms
- [RRT* (graph-based implementation)](https://arxiv.org/pdf/1105.1186)

    ![](/resources/graphics/RRT_star.png)
